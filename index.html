<!DOCTYPE html>
<html>
    <head>
            <link rel="stylesheet" href="style.css" type = "text/css">
            <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js">  </script>



    </head>
    <body>
            <!--Im aware of the fact that there are multiple simpler ways(could use an EJS file(Embedded Javascript Template) or create documents via JS) to make this grid :)--->
                    

                    <button id = "1" value = "1" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "2" value = "2" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "3" value = "3" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "4" value = "4" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "5" value = "5" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "6" value = "6" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "7" value = "7" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "8" value = "8" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "9" value = "9" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "10" value = "10" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "11" value = "11" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "12" value = "12" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "13" value = "13" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "14" value = "14" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "15" value = "15" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "16" value = "16" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "17" value = "17" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "18" value = "18" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "19" value = "19" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "20" value = "20" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "21" value = "21" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "22" value = "22" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "23" value = "23" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "24" value = "24" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "25" value = "25" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "26" value = "26" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "27" value = "27" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "28" value = "28" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "29" value = "29" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "30" value = "30" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "31" value = "31" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "32" value = "32" onmousedown="setGridCoord(this, value)"></button>

                    <button id = "33" value = "33" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "34" value = "34" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "35" value = "35" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "36" value = "36" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "37" value = "37" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "38" value = "38" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "39" value = "39" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "40" value = "40" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "41" value = "41" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "42" value = "42" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "43" value = "43" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "44" value = "44" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "45" value = "45" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "46" value = "46" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "47" value = "47" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "48" value = "48" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "49" value = "49" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "50" value = "50" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "51" value = "51" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "52" value = "52" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "53" value = "53" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "54" value = "54" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "55" value = "55" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "56" value = "56" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "57" value = "57" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "58" value = "58" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "59" value = "59" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "60" value = "60" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "61" value = "61" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "62" value = "62" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "63" value = "63" onmousedown="setGridCoord(this, value)"></button>
                    <button id = "64" value = "64" onmousedown="setGridCoord(this, value)"></button>
                    <h1 id = "refreshPage"></h2>
                    <script>
                            var points = []
                            var pointInd = 0;
                            var shortPath = [];
                            
                            var rowNum = 1;

                            // Initializes board to black and grey checker theme
                            for(var r = 0; r < 8; r++) {
                               for(var c = 0; c < 8; c++) {
                                   if(r%2 == c%2) {
                                    document.getElementById(rowNum).style.backgroundColor = "black";
                                   }
                                   rowNum++;
                                }
                            }

                    
                            // Poor naming lmao, converts an object of style {x: someInteger, y: someInteger} to an Integer
                            // JSON => Integer
                            function doubleToSingle(node) {
                                var single = node.x + 1;
                                    single += 8*(node.y);
                                return single;
                            }

                            // Initializes the knights grid coord an target location based on button input info
                            function setGridCoord(elmnt, id) {
                                
                                    points[pointInd] = id;
                                    pointInd = (pointInd + 1)%2
                                    elmnt.style.color = 'black';
                                    console.log(points);
                                    if(points[0] != null) { 
                                        document.getElementById(points[0]).style.background = "url(https://media3.giphy.com/media/LiRmbWjhccWNW/giphy.gif)";
                                        document.getElementById(points[0]).style.backgroundSize = "50px 50px";
                                    }
        

                                    if(points[0] != null && points[1] != null) {
                                        document.getElementById(points[1]).style.background = "url(https://media1.tenor.com/images/e3e7ec142988d5eb7b899025a87af4ef/tenor.gif?itemid=5605549)";
                                        document.getElementById(points[1]).style.backgroundSize = "50px 50px";
                                        calculatePaths(points[0], points[1]);
                                    }
                                    
                            }
                           
                            // Makes an AJAX Post call to API(currently local) sending knight and target coords, receives calculated knight shortest path
                            function calculatePaths(point1, point2) {
                            
                                $(document).ready(  () => {

                                        $.post("http://localhost:3000/path", {coord1: point1, coord2: point2}, (data) => {
                                            console.log("test2");
                                            //if(data==='done') {
                                                console.log(data.knightPath);
                                                for(var i = 0; i < data.knightPath.length; i++) {
                                                    shortPath.push(doubleToSingle(data.knightPath[i]));
                                                    console.log(shortPath[i]);
                                                    document.getElementById(shortPath[i]).style.backgroundColor = "blue";
                                                    if(i != 0 && i != (data.knightPath.length - 1)){
                                                    document.getElementById(shortPath[i]).style.background = "url(https://media0.giphy.com/media/MfcIIOBxCALRe/giphy.gif)";
                                                    }
                                                    document.getElementById(shortPath[i]).style.backgroundSize = "50px 50px";
                                                    document.getElementById(shortPath[i]).style.color = "white";
                                                    document.getElementById(shortPath[i]).style.textShadow = "-1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000";
                                                    document.getElementById(shortPath[i]).innerHTML = data.knightPath.length - i;
                                               }
                                                
                                                document.getElementById("refreshPage").innerHTML = "Refresh The Page To Continue (CTRL + R)";
                                                console.log("success");
                                            //}
                                            });
                                            });
                                    }
                        </script>
    </body>
</html>